# Поиск наиболее похожих товаров
## Введение
Заказчик предоставил анонимизированный набор имеющихся на складах товаров и набор новых товаров, для которых необходимо найти наиболее похожие из имеющегося набора. 
Особенность задачи состоит в том, что автоматический подбор похожих товаров должен производиться так, чтобы симулировать работу экспертов. Образцы их ответов предоставлены для обучения модели в отдельном файле вместе с примерами запросов.
## Описание данных

- **base.csv** - анонимизированный набор товаров. Каждый товар представлен как уникальный id (0-base, 1-base, 2-base) и вектор признаков размерностью 72.

- **train.csv** - обучающий датасет. Каждая строчка - один товар, для которого известен уникальный id (0-query, …, 100000-query), вектор признаков и id товара из base.csv, который максимально похож на него по мнению экспертов.

- **validation.csv** - датасет с товарами(уникальный id и вектор признаков), для которых надо найти наиболее близкие товары из base.csv.

- **validation_answer.csv** - правильные ответы к датасету с товарами для поиска (даётся для оценки работы простроенной модели).

## Задачи

- разработать алгоритм, который для всех товаров из validation.csv предложит несколько вариантов наиболее похожих товаров из base.csv;
- оценить качество алгоритма по метрике accuracy@5.

# Выводы

1. В рамках исследования были представлены 3 набора данных:
- Пропуски и дубликаты отсутсвуют
- Данные в основном представлены непрерывными числовыми значениями, основная их доля очевидно имеет нормальное распределение. 
- Данные, которые явно не характеризуются нормальным распределением были исключены из анализа, т.к. такие данные вносят лишние шумы.
- Сильных корреляционных зависимостей не выявлено.

2. Проанализирована целевая метрика в зависимости от количества кандидатов в диапозоне от 5 до 600 кандадатов и установлено:
- с увеличением количества кандидатов растет и максимальное значение целевой метрики
- увеличение количества кандидатов увеличит и время предсказания модели, так как ей придется в каждой иттерации просчитывать бОльшее количество кандидатов.

3. Для решения поставленной задачи было создано и наполнено векторное пространство из объектов анонамизированного набора данных (base). Пространство поделено на 20 кластеров, что ускоряет и уточняет процесс поиска. Для каждого объекта из train были найдены 10 ближайших векторов при помощи меры FlatL2 (при большом количестве не хватало оперативной памяти при формировании дататсетов для обучения и тестирования ML модели).

4. На тренировочном датасете (train) получаем значение метрики accuracy@5=63.114, что является хорошим результатом работы модели. Результат достигнут за счет удалениея не информативных признаков и стандартизации данных. 

5. В качестве ML модели был выбран CatBoostClassifier и проведен подбор гиперпараметров. По обученной модели пердсказаны вероятности совместимости и по найденным занчениям вероятностей  определены 5 наиболее подходящих кандидато по которым расчитано значение целевой метрики accuracy@5=61.811
